% simulation for aperiodic component extraction%	30/May/2001 by Hideki Kawahara%	30/April/2005 modification for Matlab v7.0 compatibilityy=xold*0;y(1:221:end)=1;simv=zeros(100,3);idx=1;for nl=-50:5:0	anl=10.0^(nl/20);	plv=sqrt(1-anl^2);yy=plv*y+std(y)*anl*randn(size(y));yyf=filter(1,[1 -0.99],yy-mean(yy));[apvels,dpvels,apvees,dpvees]=aperiodicpartERB(yyf,fs,f0raw*0+fs/221,f0shiftm,5,513);[mm,nn]=size(dpvees);ggg=(10*log10((dpvees(:,20:end-20)./apvees(:,20:end-20))/1));hist(ggg(:),[-60:0.5:0]);drawnowsimv(idx,1)=nl;simv(idx,2)=mean(ggg(:));simv(idx,3)=std(ggg(:));idx=idx+1;end;simv=simv(1:idx-1,:);