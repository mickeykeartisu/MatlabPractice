
	STRAIGHTをOctaveで動かす


はじめに
--------

MATLABと互換性のあるOctaveは、以前に比べ、安定性やMATLABとの互換性が
向上し、MATLABで開発されたSTRAIGHTを動かすことができるようになりました。
とは言え、少し工夫が必要ですので、その方法を説明します。

ただし、速度はかなり遅く、結果もMATLABとは少し異なっています。その辺を
納得した上で使用して下さい。

なお、**** MATLABを使用している場合は、この中に含まれるディレクトリにパスを
通しては絶対にいけません****。STRAIGHTだけでなく、MATLAB自体の誤動作につながります。


パス等の設定
------------

自分用のOctaveのパスの設定は、~/.octavercで行うことができます（「~/」は、通常はホームディレクトリ）。
また、Signal Toolboxとの互換性のために、.octavercなどで
pkg load signal
を呼んでおく必要があります。

~/.octavercは、例えば、以下のようなものになります。
----.octavercここから----
addpath ("~/matlab");
addpath ("~/octave");
pkg load signal
----.octavercここまで----
なお、2行目の~/octaveを含む行は、後述の互換性の確保のために必須です。

また、下記のようにSTRAIGHTのディレクトリ自体をパスに含めても良いでしょう。
addpath ("~/matlab/straight/STRAIGHTV40_007b");


いくつかの関数の置換・追加
------------------------

STRAIGHTで使われているいくつかの関数の挙動が異なっていたり、関数が
存在しないことがあるため、関数の置換・追加をする必要があります。
STRAIGHTの中を変えても良かったのですが、MATLABとのソースコードの共用の
ために、ここではOctaveの方で関数の置換・追加を行っています。

今の所、以下の関数の置換・追加が必要です。
- hanning: OctaveはMATLABのhannと同じ挙動になっており、MATLABのhanningとは挙動が異なります。
   さらにOctaveではhann関数がhanning関数を呼び出す形になっています。そのため、両方の関数を
   置換する必要があります。

- interp1q: interp1の高速動作版であるこの関数はOctaveには存在していないので、interp1を
   呼び出すようなinterp1qという関数を用意します。

置換・追加は、システム上のものを直接変更するのではなく、ここでは、~/octaveの中に
上記の関数のファイルを用意することにします。上記の~/.octavercで~/octaveにパスが
通っているため、~/octaveの中に存在する関数の方が優先的に呼ばれることになります。
なお、この設定により起動時にhanningに関する警告のメッセージが表示されるようになります。
また、Octaveの内部でこれらの関数を呼び出している場合に予期しない結果に
なる可能性もあります。ただ、今の所、これによる大きな問題はSTRAIGHTの実行に
関しては発生していません。

これらの関数のファイルが同梱のoctaveディレクトリに用意されています。
このoctaveディレクトリを~/に対応するフォルダにコピーして下さい。


その他の問題
------------

- STRAIGHTのGUIは動作しませんでした。動作したのはSTRAIGHTの関数群のみです。

- if文の条件に&や|を使っている場合は、警告のメッセージが表示されます。
  今のMATLABはif文の条件の中では&&や||を使うことが推奨されていますので、
  if文の条件の中に&が残っている場合は、これらに置き換えることをお勧めします。
  同梱のSTRAIGHTの中のものはできるだけ置き換えを行いました。
  
- plotのラベルや凡例などに日本語が含まれている場合は正しく機能しませんでした。
